<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat and FIM with Codestral • codestral</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Chat and FIM with Codestral">
<meta property="og:description" content="Create an addin in Rstudio to do fill-in-the-middle (FIM) and chat with latest Mistral AI models for coding, Codestral and Codestral Mamba. For more details about Mistral AI API: &lt;https://docs.mistral.ai/getting-started/quickstart/&gt; and &lt;https://docs.mistral.ai/api/&gt;. For more details about Codestral model: &lt;https://mistral.ai/news/codestral&gt;; about Codestral Mamba: &lt;https://mistral.ai/news/codestral-mamba&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">codestral</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="codestral">codestral<a class="anchor" aria-label="anchor" href="#codestral"></a>
</h1></div>
<!-- badges: start -->

<p>Thanks to an appropriate Rstudio addin, this package allows prompting <a href="https://mistral.ai/" class="external-link">Mistra AI</a> models using their API for fill in the middle (FIM) and chat in Rstudio. Installing this package creates an Addin in Rstudio that allows a direct and simple use of the Mistral AI API.</p>
<p>For FIM, the <a href="https://mistral.ai/news/codestral" class="external-link">Codestral</a> model is used.</p>
<p>For chatting, the user may use either Codestral or <a href="https://mistral.ai/news/codestral-mamba" class="external-link">Codestral Mamba</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You should first get 2 API keys from the Mistral AI <a href="https://mistral.ai/news/la-plateforme" class="external-link">Plateforme</a>:</p>
<ul>
<li>one general Mistral AI API key (menu <code>API</code> in La Plateforme).</li>
<li>one Codestral API key (menu <code>Codestral</code> in La Plateforme).</li>
</ul>
<p>You can install the development version of codestral from <a href="https://github.com/urbs-dev/codestral" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"urbs-dev/codestral"</span><span class="op">)</span></span></code></pre></div>
<p>Restart your session to activate the addin.</p>
<p><strong>The addin is now visible in the Rstudio <code>Addins</code> drop down list as <code>Codestral code completion</code>.</strong></p>
</div>
<div class="section level2">
<h2 id="set-up-for-usage-in-rstudio">Set up for usage in Rstudio<a class="anchor" aria-label="anchor" href="#set-up-for-usage-in-rstudio"></a>
</h2>
<p>The package needs to be initialized, especially to get your API key.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">codestral</span><span class="op">)</span></span>
<span><span class="co">## basic example code</span></span>
<span></span>
<span><span class="co"># replace *** with your API key</span></span>
<span><span class="co"># codestral_init(apikey = "********************************")</span></span></code></pre></div>
<p>This function also sets some parameters for using the Mistral AI API properly. Once you get familiar with the package, you may customize those parameters.</p>
</div>
<div class="section level2">
<h2 id="a-simple-example-to-start-with">A simple example to start with<a class="anchor" aria-label="anchor" href="#a-simple-example-to-start-with"></a>
</h2>
<p>Open a new text file and type: <code>"m: Hello world !"</code>. Leave your cursor at the end of the line.</p>
<p>In the Rstudio toolbar, look for the <code>Addins</code> drop down menu and click on <code>Codestral code completion</code>.</p>
<p>The model’s answer should appear in your text file starting with <code>a:</code>.</p>
<p>In your console note that the function <code>codestral:::insert_addin()</code> has been called.</p>
</div>
<div class="section level2">
<h2 id="using-codestral-package">Using codestral package<a class="anchor" aria-label="anchor" href="#using-codestral-package"></a>
</h2>
<div class="section level3">
<h3 id="fill-in-the-middle-fim">Fill in the middle (FIM)<a class="anchor" aria-label="anchor" href="#fill-in-the-middle-fim"></a>
</h3>
<p>Place your cursor where you want the FIM code to appear and look for <code>Codestral code completion</code> in the <code>Addins</code> drop down menu of <code>RStudio</code>.</p>
<p>When you click on the addin, the Codestral answer is inserted. In the request, the prompt is the part of the script before the cursor, the suffix is the part of the script after the cursor. The answer is limited to <code>max_tokens$FIM</code> as set in <code>codestral_init</code>. In case you feel the FIM is incomplete, you may just activate the addin again.</p>
</div>
<div class="section level3">
<h3 id="chat">Chat<a class="anchor" aria-label="anchor" href="#chat"></a>
</h3>
<ul>
<li><p>To prompt the Codestral model: The current script should start with <code>c:</code>. Place your cursor at the end of your question. Activate the addin as for FIM. The answer is inserted from the line after your cursor position.</p></li>
<li><p>To prompt the Codestral Mamba model: Just replace <code>c:</code> with <code>m:</code>.</p></li>
</ul>
<p>In both cases, the answer will start with <code>a:</code>.</p>
<p>You can follow up the dialog starting a new line with <code>c:</code> or <code>m:</code> after the model’s answer.</p>
</div>
<div class="section level3">
<h3 id="including-files-content">Including files content<a class="anchor" aria-label="anchor" href="#including-files-content"></a>
</h3>
<p>If you wish to include a text file (.R, .Rmd …) in your prompt, just make sure that the file is in the current working directory or one of its subdirectories (for instance in the same project) and add a line in your prompt starting by “ff:” and followed by the file name : <code>"ff:my_file.R"</code></p>
<p>Behind the scene, <code>ff:</code> triggers the insertion of the content of <code>my_file.R</code> at the location where the instruction has been placed.</p>
<p>Example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>m<span class="sc">:</span> Write the necessary unit tests <span class="cf">for</span> the following functions</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ff<span class="sc">:</span>my_fun_file.R</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="modify-the-assistant-behaviour">Modify the assistant behaviour.<a class="anchor" aria-label="anchor" href="#modify-the-assistant-behaviour"></a>
</h3>
<p>By default, when initializing the package, the assistant role is described as “You write programs in R language only. You adopt a proper coding approach by strictly naming all the functions’ parameters when calling any function with named parameters even when calling nested functions, by being straighforward in your answers.” This can be modified when initializing the package with the parameter <code>role_content</code> of <code>codestral_init</code>. However, the user may find it usefull to modify this role temporarily. This can be achieved with the marker <code>s:</code>.</p>
<p>Example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>s<span class="sc">:</span> you are an sql developer.</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>m<span class="sc">:</span> How do joints work?</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="make-it-more-efficient-using-keyboard-shortcut">Make it more efficient using keyboard shortcut<a class="anchor" aria-label="anchor" href="#make-it-more-efficient-using-keyboard-shortcut"></a>
</h2>
<p>In order to define a keyboard shortcut for this addin, in Rstudio, choose the menu <code>Tools/Addins/Browse Addins...</code> In the pop-up window, click on the <code>Keyboard shortcuts</code> button. in the new window, double click on the table’s cell at row <code>Codestral code completion</code> and column <code>Shortcut</code>. Insert your shortcut.</p>
<p>You can now replace default usage by your shortcut.</p>
<p>Additionnaly you may add the initialization step in an <code>.Rprofile</code> so that initialization is performed at any session start.</p>
</div>
<div class="section level2">
<h2 id="information-about-your-data">Information about your data<a class="anchor" aria-label="anchor" href="#information-about-your-data"></a>
</h2>
<p>Keep in mind that the point of this addin is to communicate with an API. No AI model is installed locally. Therefore every time you activate the addin, the content of the file where your cursor is, will be sent to Mistral AI. If <code>ff:my_file.R</code> is present in this file, then the content of <code>my_file.R</code> is also sent to Mistral AI.</p>
<p>The other information sent to Mistral AI is the content of the environment variables created by <code><a href="reference/codestral_init.html">codestral_init()</a></code>.</p>
<p><strong>Nothing else is sent to Mistral AI and nothing is sent to a third party.</strong></p>
<p>Note that if you are using the free services of Mistral AI, the data you sent may be used by them for training their future models. Visit their website for more information.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing codestral</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Marc Grossouvre <br><small class="roles"> Author, maintainer </small>  </li>
<li> URBS company <br><small class="roles"> Copyright holder, funder </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Marc Grossouvre, URBS company.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
